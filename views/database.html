<!DOCTYPE HTML>
<html>
	<head>
		<title>Novel Database</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<style>
			/* Basic styling for hidden tables */
			.table-section {
				display: none;
			}
			.table-section.active {
				display: block;
			}
			.table-buttons button {
				margin-right: 10px;
				padding: 10px 15px;
				cursor: pointer;
			}
			.pagination {
				margin-top: 20px;
				text-align: center;
			}
			.pagination a, .pagination span {
				display: inline-block;
				padding: 8px 16px;
				text-decoration: none;
				color: #d52349;
				border: 1px solid #ddd;
				margin: 0 4px;
				border-radius: 5px;
			}
			.pagination a.active {
				background-color: #d52349;
				color: white;
				border: 1px solid #d52349;
			}
			.pagination a:hover:not(.active) {
				background-color: #f3f3f3;
			}
			.pagination span.disabled {
				color: #ccc;
				border: 1px solid #eee;
				cursor: not-allowed;
			}
		</style>
	</head>
	<body class="is-preload">
		<div id="page-wrapper">
			<!-- Header -->
			<%- include('partials/header.html', { currentPage: 'database' }) %>

			<!-- Main -->
			<section id="main">
				<div class="container">
					<h2>Database Tables</h2>

					<div class="table-buttons">
						<button onclick="showTable('novels-table')">Novels</button>
						<button onclick="showTable('animals-table')">Animals</button>
						<button onclick="showTable('users-table')">Users</button>
					</div>

					<div id="novels-table" class="table-section active">
						<h3>Novels</h3>
						<table>
							<thead>
								<tr>
									<th>ID</th>
									<th>Year</th>
									<th>Title</th>
									<th>Publisher</th>
								</tr>
							</thead>
							<tbody>
								<% if (typeof novels !== 'undefined' && novels.length > 0) { %>
									<% novels.forEach(function(novel) { %>
										<tr>
											<td><%= novel.id %></td>
											<td><%= novel.pyear %></td>
											<td><%= novel.title %></td>
											<td><%= novel.publisher %></td>
										</tr>
									<% }); %>
								<% } else { %>
									<tr>
										<td colspan="4">No novels found.</td>
									</tr>
								<% } %>
							</tbody>
						</table>
						<div class="pagination">
							<span>Page <%= novelsPage %> of <%= totalNovelsPages %></span>
							<% if (novelsPage > 1) { %>
								<a href="<%= routePrefix %>/database?novelsPage=<%= novelsPage - 1 %>&animalsPage=<%= animalsPage %>&usersPage=<%= usersPage %>">Previous</a>
							<% } else { %>
								<span class="disabled">Previous</span>
							<% } %>
							<% for (let i = 1; i <= totalNovelsPages; i++) { %>
								<a href="<%= routePrefix %>/database?novelsPage=<%= i %>&animalsPage=<%= animalsPage %>&usersPage=<%= usersPage %>" class="<%= i === novelsPage ? 'active' : '' %>"><%= i %></a>
							<% } %>
							<% if (novelsPage < totalNovelsPages) { %>
								<a href="<%= routePrefix %>/database?novelsPage=<%= novelsPage + 1 %>&animalsPage=<%= animalsPage %>&usersPage=<%= usersPage %>">Next</a>
							<% } else { %>
								<span class="disabled">Next</span>
							<% } %>
						</div>
					</div>

					<div id="animals-table" class="table-section">
						<h3>Animals</h3>
						<table>
							<thead>
								<tr>
									<th>ID</th>
									<th>Name</th>
									<th>Species</th>
								</tr>
							</thead>
							<tbody>
								<% if (typeof animals !== 'undefined' && animals.length > 0) { %>
									<% animals.forEach(function(animal) { %>
										<tr>
											<td><%= animal.id %></td>
											<td><%= animal.aname %></td>
											<td><%= animal.species %></td>
										</tr>
									<% }); %>
								<% } else { %>
									<tr>
										<td colspan="3">No animals found.</td>
									</tr>
								<% } %>
							</tbody>
						</table>
						<div class="pagination">
							<span>Page <%= animalsPage %> of <%= totalAnimalsPages %></span>
							<% if (animalsPage > 1) { %>
								<a href="<%= routePrefix %>/database?novelsPage=<%= novelsPage %>&animalsPage=<%= animalsPage - 1 %>&usersPage=<%= usersPage %>">Previous</a>
							<% } else { %>
								<span class="disabled">Previous</span>
							<% } %>
							<% for (let i = 1; i <= totalAnimalsPages; i++) { %>
								<a href="<%= routePrefix %>/database?novelsPage=<%= novelsPage %>&animalsPage=<%= i %>&usersPage=<%= usersPage %>" class="<%= i === animalsPage ? 'active' : '' %>"><%= i %></a>
							<% } %>
							<% if (animalsPage < totalAnimalsPages) { %>
								<a href="<%= routePrefix %>/database?novelsPage=<%= novelsPage %>&animalsPage=<%= animalsPage + 1 %>&usersPage=<%= usersPage %>">Next</a>
							<% } else { %>
								<span class="disabled">Next</span>
							<% } %>
						</div>
					</div>

					<div id="users-table" class="table-section">
						<h3>Users</h3>
						<table>
							<thead>
								<tr>
									<th>ID</th>
									<th>Name</th>
									<th>Email</th>
								</tr>
							</thead>
							<tbody>
								<% if (typeof users !== 'undefined' && users.length > 0) { %>
									<% users.forEach(function(user) { %>
										<tr>
											<td><%= user.id %></td>
											<td><%= user.name %></td>
											<td><%= user.email %></td>
										</tr>
									<% }); %>
								<% } else { %>
									<tr>
										<td colspan="3">No users found.</td>
									</tr>
								<% } %>
							</tbody>
						</table>
						<div class="pagination">
							<span>Page <%= usersPage %> of <%= totalUsersPages %></span>
							<% if (usersPage > 1) { %>
								<a href="<%= routePrefix %>/database?novelsPage=<%= novelsPage %>&animalsPage=<%= animalsPage %>&usersPage=<%= usersPage - 1 %>">Previous</a>
							<% } else { %>
								<span class="disabled">Previous</span>
							<% } %>
							<% for (let i = 1; i <= totalUsersPages; i++) { %>
								<a href="<%= routePrefix %>/database?novelsPage=<%= novelsPage %>&animalsPage=<%= animalsPage %>&usersPage=<%= usersPage %>" class="<%= i === usersPage ? 'active' : '' %>"><%= i %></a>
							<% } %>
							<% if (usersPage < totalUsersPages) { %>
								<a href="<%= routePrefix %>/database?novelsPage=<%= novelsPage %>&animalsPage=<%= animalsPage %>&usersPage=<%= usersPage + 1 %>">Next</a>
							<% } else { %>
								<span class="disabled">Next</span>
							<% } %>
						</div>
					</div>
				</div>
			</section>
		</div>

		<script>
			function showTable(tableId) {
				// Hide all table sections
				document.querySelectorAll('.table-section').forEach(section => {
					section.classList.remove('active');
				});
				// Show the selected table section
				document.getElementById(tableId).classList.add('active');

				// Update URL hash to remember active tab
				window.location.hash = tableId;
			}

			document.addEventListener('DOMContentLoaded', () => {
				const urlParams = new URLSearchParams(window.location.search);
				const initialTab = window.location.hash ? window.location.hash.substring(1) : 'novels-table';
				showTable(initialTab);

				// Re-apply active class to button based on initialTab
				document.querySelectorAll('.table-buttons button').forEach(button => {
					if (button.onclick.toString().includes(initialTab)) {
						button.classList.add('active-button');
					} else {
						button.classList.remove('active-button');
					}
				});
			});
		</script>
	</body>
</html>
